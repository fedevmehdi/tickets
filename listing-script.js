function getCurrencySymbol(e){let t=e?e.toUpperCase():void 0;return({USD:"$",EUR:"â‚¬",GBP:"\xa3"})[t]||e||""}function isEventClosed(e){let t=new Date(e),n=new Date;return t<n}async function fetchTicketData(e){try{let t=`https://wow.tickets/api/tickets/event/${e}`,n=await fetch(t),c=await n.json();if(isEventClosed(c[0].event.startDateTime))return"Event is closed";return c}catch(a){return console.error("Error fetching data:",a),null}}async function populateEventsDiv(){let e=document.getElementById("wt-embed-event").getAttribute("data-event-id");e.className="wt-embed-event";let t=document.getElementById("wt-embed-event"),n=document.createElement("div");if(n.id="wt-event-listing",n.className="wt-event-listing",t.append(n),!n){console.error("Events div not found.");return}let c=document.createElement("div");c.className="wt-footer";let a=document.createElement("button");a.id="wt-checkout-button",a.className="wt-checkout-button",a.innerText="Checkout Now",c.append(a);let i=[],r=await fetchTicketData(e);if(!r){console.error("No ticket data found.");return}if("Event is closed"===r){let l=document.createElement("div");l.className="message-box";let o=document.createElement("p");o.innerText="Tickets are closed for this events.",l.append(o),n.append(l);return}r.forEach(e=>{let t=document.createElement("div");t.className="wt-ticket-details";let a=document.createElement("h3");a.className="wt-ticket-name",a.textContent=e.name;let l=document.createElement("p");l.className="wt-ticket-description",l.textContent=e.description;let o=document.createElement("p");o.className="wt-ticket-price",o.textContent=`Price: ${e.price+e.price/100*e.bookingFee} ${getCurrencySymbol(e.currency)}`;let d=document.createElement("select");d.className="wt-quantity-dropdown",d.addEventListener("change",()=>{let t=parseInt(d.value,10),n=i.find(t=>t.ticket===e.name);n?n.quantity=t:i.push({ticket:e.name,quantity:t,ticketId:e._id,currency:e.currency}),function e(){let t=0,n=null;i.forEach(e=>{let c=r.find(t=>t.name===e.ticket);if(c){if(n){if(n!==c.currency)return}else n=c.currency;t+=e.quantity*(c.price+c.price/100*c.bookingFee)}});let c=document.getElementById("wt-checkout-button");c&&(n?c.textContent=`Checkout - ${t.toFixed(2)}${getCurrencySymbol(n)}`:c.textContent="Checkout")}()});for(let s=0;s<=10;s++){let p=document.createElement("option");p.value=s,p.textContent=s,d.appendChild(p)}let u=document.createElement("div"),m=document.createElement("div");m.className="wt-cart-data",u.appendChild(a),u.appendChild(l),m.appendChild(o),m.appendChild(d),t.appendChild(u),t.appendChild(m),n.appendChild(t),n.append(c)});let d=document.getElementById("wt-checkout-button");d.addEventListener("click",()=>{!function e(t){if(t.length>0){let n=JSON.stringify(t);window.open(`https://wow.tickets/process-checkout?cart=${n}`,"_blank")}else alert("Please select tickets before proceeding to checkout.")}(i)})}document.addEventListener("DOMContentLoaded",populateEventsDiv);
